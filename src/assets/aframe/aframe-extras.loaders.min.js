!function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var m=n[s]={exports:{}};t[s][0].call(m.exports,function(e){var n=t[s][1][e];return i(n?n:e)},m,m.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){e("./src/loaders").registerAll()},{"./src/loaders":3}],2:[function(e,t,n){t.exports=THREE.PLYLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.propertyNameMapping={}},THREE.PLYLoader.prototype={constructor:THREE.PLYLoader,load:function(e,t,n,r){var i=this,o=new THREE.XHRLoader(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(i.parse(e))},n,r)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},bin2str:function(e){for(var t=new Uint8Array(e),n="",r=0;r<e.byteLength;r++)n+=String.fromCharCode(t[r]);return n},isASCII:function(e){var t=this.parseHeader(this.bin2str(e));return"ascii"===t.format},parse:function(e){return e instanceof ArrayBuffer?this.isASCII(e)?this.parseASCII(this.bin2str(e)):this.parseBinary(e):this.parseASCII(e)},parseHeader:function(e){function t(e,t){var n={type:e[0]};return"list"===n.type?(n.name=e[3],n.countType=e[1],n.itemType=e[2]):n.name=e[1],n.name in t&&(n.name=t[n.name]),n}var n=/ply([\s\S]*)end_header\s/,r="",i=0,o=n.exec(e);null!==o&&(r=o[1],i=o[0].length);for(var s,a,l={comments:[],elements:[],headerLength:i},c=r.split("\n"),m=void 0,h=0;h<c.length;h++){var u=c[h];if(u=u.trim(),""!==u)switch(a=u.split(/\s+/),s=a.shift(),u=a.join(" "),s){case"format":l.format=a[0],l.version=a[1];break;case"comment":l.comments.push(u);break;case"element":void 0!==m&&l.elements.push(m),m=Object(),m.name=a[0],m.count=parseInt(a[1]),m.properties=[];break;case"property":m.properties.push(t(a,this.propertyNameMapping));break;default:console.log("unhandled",s,a)}}return void 0!==m&&l.elements.push(m),l},parseASCIINumber:function(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}},parseASCIIElement:function(e,t){for(var n=t.split(/\s+/),r=Object(),i=0;i<e.length;i++)if("list"===e[i].type){for(var o=[],s=this.parseASCIINumber(n.shift(),e[i].countType),a=0;a<s;a++)o.push(this.parseASCIINumber(n.shift(),e[i].itemType));r[e[i].name]=o}else r[e[i].name]=this.parseASCIINumber(n.shift(),e[i].type);return r},parseASCII:function(e){var t,n=new THREE.Geometry,r=this.parseHeader(e),i=/end_header\s([\s\S]*)$/,o="";null!==(t=i.exec(e))&&(o=t[1]);var s=o.split("\n"),a=0,l=0;n.useColor=!1;for(var c=0;c<s.length;c++){var m=s[c];if(m=m.trim(),""!==m){l>=r.elements[a].count&&(a++,l=0);var h=this.parseASCIIElement(r.elements[a].properties,m);this.handleElement(n,r.elements[a].name,h),l++}}return this.postProcess(n)},postProcess:function(e){if(e.useColor){for(var t=0;t<e.faces.length;t++)e.faces[t].vertexColors=[e.colors[e.faces[t].a],e.colors[e.faces[t].b],e.colors[e.faces[t].c]];e.elementsNeedUpdate=!0}return e.computeBoundingSphere(),e},handleElement:function(e,t,n){if("vertex"===t){if(e.vertices.push(new THREE.Vector3(n.x,n.y,n.z)),"red"in n&&"green"in n&&"blue"in n){e.useColor=!0;var r=new THREE.Color;r.setRGB(n.red/255,n.green/255,n.blue/255),e.colors.push(r)}}else if("face"===t){var i=n.vertex_indices||n.vertex_index;3===i.length?e.faces.push(new THREE.Face3(i[0],i[1],i[2])):4===i.length&&e.faces.push(new THREE.Face3(i[0],i[1],i[3]),new THREE.Face3(i[1],i[2],i[3]))}},binaryRead:function(e,t,n,r){switch(n){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,r),2];case"uint16":case"ushort":return[e.getUint16(t,r),2];case"int32":case"int":return[e.getInt32(t,r),4];case"uint32":case"uint":return[e.getUint32(t,r),4];case"float32":case"float":return[e.getFloat32(t,r),4];case"float64":case"double":return[e.getFloat64(t,r),8]}},binaryReadElement:function(e,t,n,r){for(var i,o=Object(),s=0,a=0;a<n.length;a++)if("list"===n[a].type){var l=[];i=this.binaryRead(e,t+s,n[a].countType,r);var c=i[0];s+=i[1];for(var m=0;m<c;m++)i=this.binaryRead(e,t+s,n[a].itemType,r),l.push(i[0]),s+=i[1];o[n[a].name]=l}else i=this.binaryRead(e,t+s,n[a].type,r),o[n[a].name]=i[0],s+=i[1];return[o,s]},parseBinary:function(e){for(var t,n=new THREE.Geometry,r=this.parseHeader(this.bin2str(e)),i="binary_little_endian"===r.format,o=new DataView(e,r.headerLength),s=0,a=0;a<r.elements.length;a++)for(var l=0;l<r.elements[a].count;l++){t=this.binaryReadElement(o,s,r.elements[a].properties,i),s+=t[1];var c=t[0];this.handleElement(n,r.elements[a].name,c)}return this.postProcess(n)}}},{}],3:[function(e,t,n){t.exports={"ply-model":e("./ply-model"),"three-model":e("./three-model"),registerAll:function(e){this._registered||(e=e||window.AFRAME,e.systems["ply-model"]||e.registerSystem("ply-model",this["ply-model"].System),e.components["ply-model"]||e.registerComponent("ply-model",this["ply-model"].Component),e.components["three-model"]||e.registerComponent("three-model",this["three-model"]),this._registered=!0)}}},{"./ply-model":4,"./three-model":5}],4:[function(e,t,n){function r(e){return new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:16777215,shading:THREE.FlatShading,vertexColors:THREE.VertexColors,shininess:0}))}THREE.PLYLoader=e("../../lib/PLYLoader"),t.exports.System={init:function(){this.cache={}},getOrLoadGeometry:function(e,t){var n=this.cache,r=n[e];return!t&&r?r:(n[e]=new Promise(function(t){var n=new THREE.PLYLoader;n.load(e,function(e){t(e)})}),n[e])}},t.exports.Component={schema:{skipCache:{type:"boolean","default":!1},src:{type:"src"}},init:function(){this.model=null},update:function(){var e=this.data,t=this.el;return e.src?void this.system.getOrLoadGeometry(e.src,e.skipCache).then(function(e){var n=r(e);t.setObject3D("mesh",n),t.emit("model-loaded",{format:"ply",model:n})}):void console.warn("[%s] `src` property is required.",this.name)},remove:function(){this.model&&this.el.removeObject3D("mesh")}}},{"../../lib/PLYLoader":2}],5:[function(e,t,n){var r="__auto__";t.exports={schema:{src:{type:"src"},loader:{"default":"object",oneOf:["object","json"]},enableAnimation:{"default":!0},animation:{"default":r},animationDuration:{"default":0},crossorigin:{"default":""}},init:function(){this.model=null,this.mixer=null},update:function(e){e=e||{};var t,n=this.data;if(!n.src)return void this.remove();if(Object.keys(e).length){var r=this.model&&this.model.activeAction;if(n.animation!==e.animation)return r&&r.stop(),void this.playAnimation();r&&n.enableAnimation!==r.isRunning()&&(n.enableAnimation?this.playAnimation():r.stop()),r&&n.animationDuration&&r.setDuration(n.animationDuration)}else if(this.remove(),"object"===n.loader)t=new THREE.ObjectLoader,n.crossorigin&&t.setCrossOrigin(n.crossorigin),t.load(n.src,function(e){e.traverse(function(t){t instanceof THREE.SkinnedMesh&&(e=t)}),e.material&&(e.material.skinning=!!(e.geometry&&e.geometry.bones||[]).length),this.load(e)}.bind(this));else{if("json"!==n.loader)throw new Error('[three-model] Invalid mode "%s".',n.mode);t=new THREE.JSONLoader,n.crossorigin&&(t.crossOrigin=n.crossorigin),t.load(n.src,function(e,t){t.forEach(function(t){t.vertexColors=(e.faces[0]||{}).color?THREE.FaceColors:THREE.NoColors,t.skinning=!!(e.bones||[]).length,t.morphTargets=!!(e.morphTargets||[]).length,t.morphNormals=!!(e.morphNormals||[]).length});var n=(e.bones||[]).length?new THREE.SkinnedMesh(e,new THREE.MultiMaterial(t)):new THREE.Mesh(e,new THREE.MultiMaterial(t));this.load(n)}.bind(this))}},load:function(e){this.model=e,this.mixer=new THREE.AnimationMixer(this.model),this.el.setObject3D("mesh",e),this.el.emit("model-loaded",{format:"three",model:e}),this.data.enableAnimation&&this.playAnimation()},playAnimation:function(){var e,t=this.data,n=this.model.animations||this.model.geometry.animations||[];if(t.enableAnimation&&t.animation&&n.length){if(e=t.animation===r?n[0]:THREE.AnimationClip.findByName(n,t.animation),!e)return void console.error('[three-model] Animation "%s" not found.',t.animation);this.model.activeAction=this.mixer.clipAction(e,this.model),t.animationDuration&&this.model.activeAction.setDuration(t.animationDuration),this.model.activeAction.play()}},remove:function(){this.mixer&&this.mixer.stopAllAction(),this.model&&this.el.removeObject3D("mesh")},tick:function(e,t){this.mixer&&!isNaN(t)&&this.mixer.update(t/1e3)}}},{}]},{},[1]);